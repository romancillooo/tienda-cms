<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h2>{{ productId ? 'Editar Producto' : 'Añadir Nuevo Producto' }}</h2>
    </div>
    <div class="card-body">
      <form [formGroup]="productForm" (ngSubmit)="onSubmit()" enctype="multipart/form-data">
        <div class="form-group">
          <label for="name">Nombre del Producto</label>
          <input id="name" formControlName="name" class="form-control" placeholder="Ingresa el Nombre del Producto" />
        </div>
        <div class="form-group">
          <label for="brand_id">Marca</label>
          <select id="brand_id" formControlName="brand_id" class="form-control">
            <option *ngFor="let brand of brands" [value]="brand.id">{{ brand.name }}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="category_id">Categoría</label>
          <select id="category_id" formControlName="category_id" class="form-control">
            <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="price">Precio</label>
          <input id="price" formControlName="price" type="number" class="form-control" />
        </div>
        <div class="form-group">
          <label for="image">Imagen</label>
          <input type="file" id="image" (change)="onFileChange($event)" class="form-control" />
          <img *ngIf="previewUrl" [src]="previewUrl" alt="Vista previa" class="img-thumbnail mt-2" style="width: 100px;">
        </div>
        <div class="form-group">
          <label for="available_sizes">Tamaños Disponibles (separados por comas)</label>
          <input id="available_sizes" formControlName="available_sizes_string" class="form-control" />
        </div>
        <div class="form-group">
          <label for="gallery">Galería de Imágenes</label>
          <div class="gallery-drop-zone" (click)="openFileBrowser()" (drop)="onDrop($event)" (dragover)="onDragOver($event)">
            <div *ngIf="galleryPreviews.length === 0">Drop your images here!</div>
            <div class="gallery-preview">
              <div *ngFor="let preview of galleryPreviews" class="image-preview">
                <img [src]="preview" alt="Gallery Image" />
                <button type="button" (click)="removeImage(preview, $event)" class="btn btn-sm"><i class="fas fa-trash"></i></button>
              </div>
            </div>
          </div>
        </div>
        <input type="file" id="galleryInput" (change)="onGalleryFileChange($event)" multiple class="form-control mt-2" style="display: none;" />
        <div class="button-group">
          <button type="submit" class="btn btn-primary">{{ productId ? 'Actualizar' : 'Crear' }}</button>
          <a routerLink="/products" class="btn btn-danger">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</div>
